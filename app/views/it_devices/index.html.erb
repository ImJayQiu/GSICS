<h2>Listing IT Devices</h2>

<table>
  <tr>
    <% if can? :create, :it_devices %>
      <th><%= button_to 'Add New Device', new_it_device_path, :method=>:get %></th>
    <% end %>
  </tr>
</table>


<table>
  <tr>
    <th>Index</th>
    <th>Code</th>
    <th>Type</th>
    <th>Dept.Abb.</th>
    <th>User</th>
    <th>IP</th>
    <th colspan="3">Operations</th>
  </tr>

  <% @it_devices.each_with_index do |it_device, i| %>
    <% @dept_abb = Department.where(:code=>it_device.dept).first.abb rescue nil %>
    <tr>
      <td><%= i+1 %></td>
      <td><%= it_device.code rescue nil %></td>
      <td><%= it_device.c_type rescue nil %></td>
      <td><%= @dept_abb rescue nil %></td>
      <td><%= it_device.user rescue nil %></td>
      <td><%= it_device.ip rescue nil %></td>

      <% if can? :view, :it_devices %>
        <td><%= button_to 'Show', it_device, :method=>:get %></td>
      <% end %>

      <% if can? :edit, :it_devices %>
        <td><%= button_to 'Edit', edit_it_device_path(it_device), :method=>:get %></td>
      <% end %>

      <% if can? :manage, :all %>
        <td><%= button_to 'Del', it_device, :confirm => 'Are you sure?', :method => :delete %></td>
      <% end %>

    </tr>

  <% end %>
</table>


<table>
  <tr>
    <% if can? :create, :it_devices %>
      <th><%= button_to 'Add New Device', new_it_device_path, :method=>:get %></th>
    <% end %>
  </tr>
</table>